<!DOCTYPE html>
{% load static %}
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        body {font-family: Arial, Helvetica, sans-serif;}
        * {box-sizing: border-box;}
        
        /* Button used to open the chat form - fixed at the bottom of the page */
        .open-button {
          background-color: #555;
          color: white;
          padding: 16px 20px;
          border: none;
          cursor: pointer;
          opacity: 0.8;
          position: fixed;
          bottom: 23px;
          right: 28px;
          width: 280px;
        }
        
        /* The popup chat - hidden by default */
        .chat-popup {
          display: none;
          position: fixed;
          bottom: 0;
          right: 15px;
          border: 3px solid #f1f1f1;
          z-index: 9;
        }
        
        /* Add styles to the form container */
        .form-container {
          max-width: 300px;
          padding: 10px;
          background-color: white;
        }
        
        /* Full-width textarea */
        .form-container textarea {
          width: 100%;
          padding: 15px;
          margin: 5px 0 22px 0;
          border: none;
          background: #f1f1f1;
          resize: none;
          min-height: 200px;
        }
        
        /* When the textarea gets focus, do something */
        .form-container textarea:focus {
          background-color: #ddd;
          outline: none;
        }
        
        /* Set a style for the submit/send button */
        .form-container .btn {
          background-color: #04AA6D;
          color: white;
          padding: 16px 20px;
          border: none;
          cursor: pointer;
          width: 100%;
          margin-bottom:10px;
          opacity: 0.8;
        }
        
        /* Add a red background color to the cancel button */
        .form-container .cancel {
          background-color: red;
        }
        
        /* Add some hover effects to buttons */
        .form-container .btn:hover, .open-button:hover {
          opacity: 1;
        }
    </style>
    <title>Document</title>
</head>
<body>
    This is the chat gpt chat bord 
    <!-- <form action="{% url 'restaurant:chatgpt' %}" method="POST">
        {% csrf_token %}
        <div class="input-group">
            <textarea type="text" name="prompt" class="form-control" row="2" placeholder="write anything here and get response..." required></textarea>
            <button type="submit" class = "btn btn-primary">
                <i class="fas fa-search">click here</i>
            </button>
        </div>
        <button type="submit" class = "btn btn-primary py-1 mt-3">submit</button>
    </form> -->
    <!-- {% if prompt %}
    <span id="scrollTo"></span>
    {% endif %}
    {% if chatResponse %}
    <div class="col-lg-7 col-md-7 col-12 mx-auto px-lg-5 px-md-4">
        <h6 class="test-black">
            <b>{{prompt|linebreaksbr}}</b>
        </h6>
        <p class="text-black">
            {{chatResponse|linebreaksbr}}
        </p>
    </div>
    {% endif %} -->
    <span id="service"></span>==============================================================================
    <button class="open-button" onclick="openForm()">ChatGPT</button>

    <div class="chat-popup" id="myForm">
        <!-- <form action="{% url 'restaurant:chatgpt' %}" method="POST" class="form-container"> -->
          {% csrf_token %}
          <h1>ChatGPT</h1>
          {% if chatResponse %}
          <div class="input-group">
              <p class="text-black" name="prompt" row="4" id="myDiv" style="height:100px;width:97%;overflow:auto;border:8px solid yellowgreen;padding:2%">
                  {{chatResponse}}
              </p>
          </div>
          {% if prompt %}
          <span id="scrollTo"></span>
          {% endif %}
          {% endif %}

          <div class="input-group">
              <textarea type="text" name="prompt" id="myTextarea" class="form-control" row="2" placeholder="write anything here and get response..." required></textarea>
              <button type="submit" id="myButton" class = "btn btn-primary"> Submit</button>
          </div> -->
          <!-- <button type="submit" class = "btn btn-primary" >submit</button> -->
          <button type="button" class="btn cancel" onclick="closeForm()">Close</button>
          {% if prompt %}
          <span id="scrollTo"></span>
          {% endif %}
        <!-- </form> -->
    </div>

<script>
function openForm() {
  document.getElementById("myForm").style.display = "block";
}

function closeForm() {
  document.getElementById("myForm").style.display = "none";
}
</script>

<script>
    function scrollToElement(elementId){
        $('html, body').animate({
            scrollTop: $(`#${elementId}`).offset().top
        }, 1000);
    }
    scrollToElement('scrollTo')
</script>

<script>
  const textarea = document.getElementById("myTextarea");
  const button = document.getElementById("myButton");
  const div = document.getElementById("myDiv");

  button.addEventListener("click", () => {
    const xhr = new XMLHttpRequest();
    xhr.open("POST", "{% url 'restaurant:chatgpt' %}");
    xhr.setRequestHeader("Content-Type", "application/json");
    xhr.onload = () => {
      if (xhr.status === 200) {
        const response = JSON.parse(xhr.responseText);
        div.innerHTML = response.result;
      }
    };
    const data = {
      input_text: textarea.value,
    };
    console.log(textarea.value)
    xhr.send(JSON.stringify(data));
  });
</script>


    <!-- <script>
        src = "https://cdn.jsdelivr.net/npm/bootstrap@405.0.0/dist/js/bootstrap.bundle.min.js"
        crossorigin='anonymous'
    </script> -->
</body>
</html>